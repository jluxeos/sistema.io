<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ruleta de Descuentos JLUXE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Orbitron', Arial, sans-serif;
      background: linear-gradient(135deg, #fffde4 0%, #f4faff 100%);
      color: #222;
      text-align: center;
      min-height: 100vh;
      margin: 0;
    }
    .jluxe-title {
      margin-top: 48px;
      font-size: 3em;
      font-weight: bold;
      letter-spacing: 5px;
      color: #2a65ff;
      text-shadow: 0 0 16px #dbe8ff, 0 0 32px #39f6ff;
      font-family: 'Orbitron', Arial, sans-serif;
    }
    .ruleta-container {
      margin: 32px auto 0 auto;
      width: 340px;
      position: relative;
    }
    .ruleta-box {
      position: relative;
      width: 340px;
      height: 200px;
      border-radius: 36px;
      background: linear-gradient(120deg, #39f6ff 0%, #ffee32 100%);
      box-shadow: 0 0 45px #ffee32, 0 0 16px #39f6ff inset;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      margin-bottom: 24px;
    }
    .descuento-final {
      font-size: 3.2em;
      font-weight: bold;
      color: #2a65ff;
      text-shadow: 0 0 24px #ffee32, 0 0 40px #39f6ff;
      letter-spacing: 2px;
      margin: 0;
      opacity: 0;
      transform: scale(0.85);
      transition: opacity 0.7s, transform 0.7s;
    }
    .descuento-final.visible {
      opacity: 1;
      transform: scale(1.1);
    }
    .contador-tiros {
      margin-top: 12px;
      font-size: 1.2em;
      color: #2a65ff;
      text-shadow: 0 0 6px #ffee32;
      letter-spacing: 2px;
    }
    .botones {
      margin: 32px 0 0 0;
      display: flex;
      flex-direction: row;
      justify-content: center;
      gap: 24px;
      flex-wrap: wrap;
    }
    .btn {
      padding: 16px 38px;
      font-size: 1.15em;
      border-radius: 13px;
      border: none;
      background: linear-gradient(90deg, #39f6ff 0%, #ffee32 100%);
      color: #2a65ff;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 0 12px #ffee32;
      transition: background 0.25s, box-shadow 0.25s, transform 0.2s;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-family: 'Orbitron', Arial, sans-serif;
      margin-bottom: 8px;
    }
    .btn:disabled {
      background: #f0f0f0;
      color: #bbb;
      box-shadow: none;
      cursor: not-allowed;
      opacity: 0.7;
    }
    .codigo-descuento {
      margin: 28px auto 0 auto;
      font-size: 1.5em;
      color: #39f6ff;
      background: #f8fffa;
      border: 2px dashed #39f6ff;
      border-radius: 10px;
      padding: 12px 32px;
      width: fit-content;
      box-shadow: 0 0 18px #ffee32;
      letter-spacing: 3px;
      font-family: 'Orbitron', Arial, sans-serif;
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 0.7s, transform 0.7s;
    }
    .codigo-descuento.visible {
      opacity: 1;
      transform: scale(1.07);
    }
    .btn-codigo {
      margin: 32px auto 0 auto;
      display: block;
    }
    /* Botón super oculto */
    #resetBtn {
      opacity: 0;
      position: fixed;
      left: 0;
      bottom: 0;
      width: 40px;
      height: 40px;
      z-index: 99;
      border: none;
      background: transparent;
      cursor: pointer;
      pointer-events: auto;
    }
    @media (max-width: 400px) {
      .ruleta-container, .ruleta-box { width: 90vw; }
      .botones { gap: 12px; }
      #resetBtn { width: 30px; height: 30px; }
    }
  </style>
  <link href="https://fonts.googleapis.com/css?family=Orbitron:700" rel="stylesheet">
</head>
<body>
  <div class="jluxe-title">JLUXE</div>
  <div class="ruleta-container">
    <div class="ruleta-box">
      <div class="descuento-final" id="descuentoFinal">?</div>
    </div>
    <div class="contador-tiros" id="contadorTiros">Tiros realizados: 0</div>
  </div>
  <div class="botones">
    <button class="btn" id="tirarBtn">Intentar suerte</button>
    <button class="btn" id="verBtn">Ver mi descuento</button>
    <button class="btn" id="mapsBtn">Visita nuestra sucursal para tener una segunda oportunidad</button>
    <button class="btn" id="waBtn">Envíanos un WhatsApp para validarlo</button>
  </div>
  <button id="resetBtn" title="Reset super oculto"></button>
  <button class="btn btn-codigo" id="codigoBtn" style="display:none;">Generar código de descuento</button>
  <div class="codigo-descuento" id="codigoDescuento"></div>
  <script>
    // Configuración de descuentos y probabilidades
    const descuentos = Array.from({length: 19}, (_, i) => i + 1);
    function getRandomDescuento() {
      const rand = Math.random();
      if(rand < 0.95) {
        // 1-10 (más probabilidad)
        const idx = Math.floor(rand / 0.095); // 0.095 = 9.5% por cada uno
        return idx + 1; // 1% al 10%
      } else {
        // 11-19 (difícil)
        const idx = Math.floor(Math.random() * 9) + 11;
        return idx; // 11% al 19%
      }
    }

    // LocalStorage para simular "solo un intento por usuario" y contar tiros
    const STORAGE_DESC = "jluxe-ruleta-descuento";
    const STORAGE_TIRO = "jluxe-ruleta-tiros";
    const STORAGE_CODE = "jluxe-ruleta-codigo";
    function guardarDescuento(valor) {
      localStorage.setItem(STORAGE_DESC, valor);
    }
    function obtenerDescuento() {
      return localStorage.getItem(STORAGE_DESC);
    }
    function reiniciarDescuento() {
      localStorage.removeItem(STORAGE_DESC);
    }
    function guardarTiro() {
      let tiros = obtenerTiros();
      tiros++;
      localStorage.setItem(STORAGE_TIRO, tiros);
      return tiros;
    }
    function obtenerTiros() {
      return parseInt(localStorage.getItem(STORAGE_TIRO) || "0", 10);
    }
    function reiniciarTiros() {
      localStorage.setItem(STORAGE_TIRO, "0");
    }
    function guardarCodigo(valor) {
      localStorage.setItem(STORAGE_CODE, valor);
    }
    function obtenerCodigo() {
      return localStorage.getItem(STORAGE_CODE);
    }
    function reiniciarCodigo() {
      localStorage.removeItem(STORAGE_CODE);
    }
    function generarCodigo(descuento) {
      // Sencillo: JLUXE + descuento + 6 caracteres aleatorios
      let aleatorio = Math.random().toString(36).substr(2,6).toUpperCase();
      return `JLUXE-${descuento}-${aleatorio}`;
    }

    const tirarBtn = document.getElementById("tirarBtn");
    const verBtn = document.getElementById("verBtn");
    const mapsBtn = document.getElementById("mapsBtn");
    const waBtn = document.getElementById("waBtn");
    const resetBtn = document.getElementById("resetBtn");
    const descuentoDiv = document.getElementById("descuentoFinal");
    const contadorDiv = document.getElementById("contadorTiros");
    const codigoBtn = document.getElementById("codigoBtn");
    const codigoDiv = document.getElementById("codigoDescuento");

    function mostrarDescuento(valor) {
      descuentoDiv.textContent = valor ? valor + "%" : "?";
      descuentoDiv.classList.add("visible");
    }

    function ocultarDescuento() {
      descuentoDiv.textContent = "?";
      descuentoDiv.classList.remove("visible");
    }

    function mostrarCodigo(valor) {
      codigoDiv.textContent = valor;
      codigoDiv.classList.add("visible");
    }

    function ocultarCodigo() {
      codigoDiv.textContent = "";
      codigoDiv.classList.remove("visible");
    }

    function actualizarBotones() {
      const descuento = obtenerDescuento();
      const codigo = obtenerCodigo();
      if (descuento) {
        tirarBtn.disabled = true;
        verBtn.disabled = false;
        mostrarDescuento(descuento);
        codigoBtn.style.display = "block";
        if (codigo) {
          mostrarCodigo(codigo);
          codigoBtn.disabled = true;
        } else {
          ocultarCodigo();
          codigoBtn.disabled = false;
        }
      } else {
        tirarBtn.disabled = false;
        verBtn.disabled = true;
        ocultarDescuento();
        ocultarCodigo();
        codigoBtn.style.display = "none";
      }
      contadorDiv.textContent = "Tiros realizados: " + obtenerTiros();
    }

    tirarBtn.addEventListener("click", () => {
      if (!obtenerDescuento()) {
        const resultado = getRandomDescuento();
        guardarDescuento(resultado);
        guardarTiro();
        mostrarDescuento(resultado);
        tirarBtn.disabled = true;
        verBtn.disabled = false;
        codigoBtn.style.display = "block";
        contadorDiv.textContent = "Tiros realizados: " + obtenerTiros();
      }
    });

    verBtn.addEventListener("click", () => {
      const descuento = obtenerDescuento();
      if (descuento) {
        mostrarDescuento(descuento);
      }
    });

    codigoBtn.addEventListener("click", () => {
      const descuento = obtenerDescuento();
      if (descuento && !obtenerCodigo()) {
        const codigo = generarCodigo(descuento);
        guardarCodigo(codigo);
        mostrarCodigo(codigo);
        codigoBtn.disabled = true;
      }
    });

    // Botón super oculto para reiniciar (solo tú sabes dónde está)
    resetBtn.addEventListener("click", () => {
      reiniciarDescuento();
      reiniciarTiros();
      reiniciarCodigo();
      actualizarBotones();
      ocultarCodigo();
      ocultarDescuento();
    });

    // Botón Maps
    mapsBtn.addEventListener("click", () => {
      window.open("https://www.google.com/maps/search/?api=1&query=JLUXE+Original+Sneakers", "_blank");
    });

    // Botón Whatsapp
    waBtn.addEventListener("click", () => {
      window.open("https://w.app/zhznmt", "_blank");
    });

    // Inicializar
    actualizarBotones();
  </script>
</body>
</html>
